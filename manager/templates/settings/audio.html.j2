{% extends "settings.html.j2" %}
{% block content %}
<h4>Audio output</h4>
<span id="audio_devices"></span>
{% endblock content %}

{% block init_cmds %}'settings/audio/devices'{% endblock init_cmds %}

<script type="text/javascript" charset="utf-8">
{% block recv_cmds %}
case 'settings/audio/devices':
    var dev_select = byId('audio_devices');
    dev_select.innerHTML='';
    data.devices.forEach(device => {
        {# dev_select.innerHTML+=`<option value="${device.name}" ${ device.default === 'true' ?'selected':'' }>${device.description}</option>\n`; #}
        dev_select.innerHTML+= `
        <div class="form-check">
            <input class="form-check-input" type="radio" name="audioRadio" id="${device.name}" onchange="sendCommand('settings/audio/default', {device: '${device.name}'})" ${(device.default)?'checked':''}>
            <label class="form-check-label" for="${device.name}">${device.description}</label>
            <div class="row">
                <div class="col-1">
                    <button type="button" class="btn btn-link p-0" onclick="sendCommand('settings/audio/mute', {device: '${device.name}', mute: ${!device.mute}})" style="color: ${(device.mute)?'red':'blue'}"><i class="bi bi-volume-${(device.mute)?'mute':'up'}"></i></button>
                </div>
                <div class="col-10">
                    <input type="range" class="form-range" id="${device.name}-volume" min="0" max="1.0" step="0.01" value="${device.volume}" onchange="sendCommand('settings/audio/volume', {device: '${device.name}', volume: parseFloat(this.value)})">
                </div>
                <div class="col-1"><p>${Math.round(device.volume*100)}%</p></div>
            </div>
        </div>
        `;
    });
    break;
{% endblock recv_cmds %}
</script>
